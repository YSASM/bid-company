<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>layout 管理系统大布局 - Layui</title>
  <link rel="stylesheet" href="/static/css/layui.css">
  <script src="/static/layui.js"></script>
</head>
<body>
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <div class="layui-logo layui-hide-xs layui-bg-black">企业API管理面板</div>
    <!-- 头部区域（可配合layui 已有的水平导航） -->
    <ul class="layui-nav layui-layout-left">
      <!-- 移动端显示 -->
      <li class="layui-nav-item layui-show-xs-inline-block layui-hide-sm" lay-header-event="menuLeft">
        <i class="layui-icon layui-icon-spread-left"></i>
      </li>
      <!-- <li class="layui-nav-item layui-hide-xs"><a href="">nav 1</a></li> -->
    </ul>
  </div>
  
  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree" lay-filter="test">
        <li class="layui-nav-item"><a href="javascript:;">日志</a></li>
      </ul>
    </div>
  </div>
  <div class="layui-body">
    <!-- 内容主体区域 -->
    <div class="layui-card">
      <div class="layui-container"> 
        <div class="layui-row layui-col-space10">
          <div class="layui-col-md2">
            <button class="layui-btn method layui-btn-primary" data-id="111">查询方式</button>
          </div>
          <div id="idinput1" class="layui-col-md4">
            <div class="layui-col-md6">
                <div class="layui-col-md6">
              <label class="layui-form-label">ID：</label>
              </div>
              <div class="layui-col-md6">
                <input type="text" id="id" class="layui-input" placeholder="请输入">
              </div>
            </div>
          </div>
          <div id="idinput2" class="layui-col-md4"></div>
          <div id="wordsinput1" class="layui-col-md4">
            <div class="layui-col-md6">
                <div class="layui-col-md6">
              <label class="layui-form-label">关键字：</label>
              </div>
              <div class="layui-col-md6">
                <input type="text" id="words" class="layui-input" placeholder="请输入">
              </div>
            </div>
          </div>
          <div id="wordsinput2" class="layui-col-md4"></div>
          <div id="timeinputstart" class="layui-col-md4">
            <div class="layui-col-md6">
                <div class="layui-col-md6">
              <label class="layui-form-label">开始时间：</label>
              </div>
              <div class="layui-col-md6">
                <input type="text" id="time" name="lasttime"class="layui-input" placeholder="请输入">
              </div>
            </div>
          </div>
          <div id="timeinputend" class="layui-col-md4">
            <div class="layui-col-md6">
              <div class="layui-col-md6">
              <label class="layui-form-label">结束时间：</label>
              </div>
              <div class="layui-col-md6">
                <input type="text" id="time" name="lasttime"class="layui-input" placeholder="请输入">
              </div>
            </div>
          </div>
          <div class="layui-col-md2">
            <button  class="layui-btn layui-btn-primary" lay-submit lay-filter="search">查找</button>
          </div>
        </div>
        <div class="layui-col-md12">
          <table id="log" lay-filter="test"></table>
        </div>
      </div>
  </div>
  <div class="layui-footer">
    <!-- 底部固定区域 -->
    远略科技
  </div>
</div>
<script>
  layui.use(['form','laydate','dropdown','table'], function(){
    var url = 'http://9252.gr984e2a.i8tkcg64.786129.grapps.cn/log?method=all'
    var method = 'id'
    var table = layui.table;
    //第一个实例
    table.render({
      elem: '#log'
      ,id: 'logstable'
      ,height: 700
      ,url: url //数据接口
      ,page: true //开启分页
      ,cols: [[ //表头
        {field: 'id', title: 'ID', width:100, sort: true, fixed: 'left'}
        ,{field: 'words', title: '关键字', width:100}
        ,{field: 'ip', title: 'IP', width:100}
        ,{field: 'type', title: '请求类型', width:100} 
        ,{field: 'api_name', title: '数据来源', width: 100}
        ,{field: 'code', title: '状态码', width: 100}
        ,{field: 'msg', title: '状态信息', width: 100}
        ,{field: 'request_time', title: '请求耗时', width: 100}
        ,{field: 'create_time', title: '日志时间', width: 100}
        ,{field: 'data', title: '返回信息', width: 100}
        ,{field: 'error', title: '错误信息', width: 100}
      ]]
    });
    url = 'http://9252.gr984e2a.i8tkcg64.786129.grapps.cn/log?method=id'
    var  form = layui.form ;
            $ = layui.jquery ;
             laydate = layui.laydate;
          
        laydate.render({     //创建时间选择框
              elem: '#time' //指定元素
            });
    var dropdown = layui.dropdown
    ,$ = layui.jquery;
    $("#idinput1").show();
    $("#idinput2").show();
    $("#wordsinput1").hide();
    $("#wordsinput2").hide();
    $("#timeinputstart").hide();
    $("#timeinputend").hide();
    dropdown.render({
      elem: '.method'
      ,data: [{
        title: '通过id查询'
        ,method: 'id'
      }, {
        title: '通过时间查询'
        ,method: 'time'
      }, {
        title: '通过关键字查询'
        ,method: 'words'
      }]
      ,click: function(data, othis){
        var elem = $(this.elem)
        ,listId = elem.data('id'); //表格列表的预埋数据
        url = 'http://9252.gr984e2a.i8tkcg64.786129.grapps.cn/log?method='+ data.method
        method = data.method
        if(data.method=='id'){
          $("#idinput1").show();
          $("#idinput2").show();
          $("#wordsinput1").hide();
          $("#wordsinput2").hide();
          $("#timeinputstart").hide();
          $("#timeinputend").hide();
        }
        else if(data.method=="words"){
          $("#wordsinput1").show();
          $("#wordsinput2").show();
          $("#idinput1").hide();
          $("#idinput2").hide();
          $("#timeinputstart").hide();
          $("#timeinputend").hide();
        }
        else if(data.method=='time'){
          $("#timeinputstart").show();
          $("#timeinputend").show();
          $("#idinput1").hide();
          $("#idinput2").hide();
          $("#wordsinput1").hide();
          $("#wordsinput2").hide();
        }
        layer.msg(url);
      }
    });
    var search = layui.form;
    search.on('submit(search)', function (data) {
      if(method=='id'){
        old_url = url
        v = $("#id").val()
        if(v==''){
          url = old_url
          layer.msg("空id");
          return
        }
        url = url+"&id=" + v;
        table.reloadData('logstable', {
          url:url
        })
        url = old_url
      }
    // layer.msg("qwe");
	  });
  });
</script>
<script>
//JS 
layui.use(['element', 'layer', 'util'], function(){
  var element = layui.element
  ,layer = layui.layer
  ,util = layui.util
  ,$ = layui.$;
  
  //头部事件
  util.event('lay-header-event', {
    //左侧菜单事件
    menuLeft: function(othis){
      layer.msg('展开左侧菜单的操作', {icon: 0});
    }
    ,menuRight: function(){
      layer.open({
        type: 1
        ,content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
        ,area: ['260px', '100%']
        ,offset: 'rt' //右上角
        ,anim: 5
        ,shadeClose: true
      });
    }
  });
  
});
</script>
</body>
</html>